<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nuclear Decay Explorer (Dark)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/feather-icons"></script>
  <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.globe.min.js"></script>
  <style>
    .fade-in { animation: fadeIn 0.5s ease-in; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .decay-chain-item { transition: all 0.3s ease; }
    .decay-chain-item:hover { transform: scale(1.02); background-color: rgba(74, 222, 128, 0.1); }

    .glow { box-shadow: 0 0 15px rgba(74, 222, 128, 0.7); }
    .radioactive { animation: pulse 2s infinite; }
    @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
  </style>
</head>

<body class="bg-gray-900 text-gray-100 min-h-screen">
  <div id="vanta-bg" class="fixed inset-0 -z-10 opacity-30"></div>

  <div class="relative z-10 max-w-6xl mx-auto px-4 py-8">

    <!-- Header -->
    <header class="text-center mb-12">
      <h1 class="text-5xl font-bold bg-gradient-to-r from-green-400 to-blue-500 text-transparent bg-clip-text mb-2">
        Decay Detective
      </h1>
      <p class="text-lg text-gray-300">Calculate radioactive decay probabilities and visualize decay chains</p>
      <div class="mt-4 flex justify-center">
        <i data-feather="activity" class="text-green-400 w-10 h-10 radioactive"></i>
      </div>
    </header>

    <!-- Input Section -->
    <div class="bg-gray-800 rounded-xl shadow-2xl p-6 mb-8 backdrop-blur-sm bg-opacity-90 glow">
      <div class="mb-6">
        <label for="isotope-search" class="block text-lg font-medium text-gray-300 mb-2">Select Radioactive Isotope</label>
        <div class="relative">
          <input type="text" id="isotope-search"
            class="w-full p-4 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-green-400 focus:border-transparent"
            placeholder="e.g. Uranium-238, Carbon-14, Iodine-131">
          <div id="suggestions"
            class="absolute z-20 w-full mt-1 bg-gray-800 border border-gray-700 rounded-lg shadow-lg hidden max-h-60 overflow-y-auto text-gray-100">
          </div>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
        <div>
          <label for="time-value" class="block text-lg font-medium text-gray-300 mb-2">Time Interval</label>
          <div class="flex">
            <input type="number" id="time-value"
              class="flex-1 p-4 bg-gray-700 border border-gray-600 rounded-l-lg text-white focus:ring-2 focus:ring-green-400 focus:border-transparent"
              placeholder="Enter time" min="0" step="0.01">
            <select id="time-unit"
              class="p-4 bg-gray-700 border border-gray-600 rounded-r-lg text-white focus:ring-2 focus:ring-green-400 focus:border-transparent">
              <option value="seconds">seconds</option>
              <option value="minutes">minutes</option>
              <option value="hours">hours</option>
              <option value="days">days</option>
              <option value="years" selected>years</option>
            </select>
          </div>
        </div>

        <div>
          <label for="initial-nuclei" class="block text-lg font-medium text-gray-300 mb-2">Initial Nuclei (optional)</label>
          <input type="number" id="initial-nuclei"
            class="w-full p-4 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-green-400 focus:border-transparent"
            placeholder="Default: 1" min="1" value="1">
        </div>
      </div>

      <div class="text-center">
        <button id="calculate-btn"
          class="px-8 py-4 bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700 text-white font-bold rounded-lg transform hover:scale-105 flex items-center justify-center">
          <i data-feather="zap" class="mr-2"></i> Calculate Decay
        </button>
      </div>
    </div>

    <!-- Results Section -->
    <div id="results-section" class="hidden">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <div class="bg-gray-800 border border-gray-700 rounded-xl p-6 fade-in">
          <div class="flex items-center mb-4">
            <i data-feather="activity" class="text-green-400 mr-3"></i>
            <h3 class="text-xl font-semibold text-green-400">Decay Probability</h3>
          </div>
          <div class="text-3xl font-bold text-green-300 mb-2" id="decay-probability">0%</div>
          <p class="text-gray-400">Chance that a nucleus decays in the given time</p>
        </div>

        <div class="bg-gray-800 border border-gray-700 rounded-xl p-6 fade-in">
          <div class="flex items-center mb-4">
            <i data-feather="layers" class="text-blue-400 mr-3"></i>
            <h3 class="text-xl font-semibold text-blue-400">Remaining Nuclei</h3>
          </div>
          <div class="text-3xl font-bold text-blue-300 mb-2" id="remaining-nuclei">0</div>
          <p class="text-gray-400">Expected number of nuclei remaining</p>
        </div>
      </div>

      <div class="bg-gray-800 rounded-xl shadow-xl p-6 backdrop-blur-sm bg-opacity-90 mb-8 border border-gray-700">
        <div class="flex items-center mb-6">
          <i data-feather="git-commit" class="text-purple-400 mr-3"></i>
          <h2 class="text-2xl font-bold text-gray-200">Decay Chain</h2>
        </div>
        <div id="decay-chain" class="space-y-4"></div>
      </div>

      <div class="bg-gray-800 border border-yellow-600 rounded-xl p-6 fade-in">
        <div class="flex items-center mb-4">
          <i data-feather="info" class="text-yellow-400 mr-3"></i>
          <h3 class="text-xl font-semibold text-yellow-400">Interpretation</h3>
        </div>
        <p class="text-gray-300" id="interpretation"></p>
      </div>
    </div>

    <footer class="mt-12 text-center text-gray-500 text-sm">
      <p>Made with <i data-feather="heart" class="inline w-4 h-4 text-red-400"></i> for nuclear science enthusiasts</p>
    </footer>
  </div>

  <script>
    // Vanta.js background
    VANTA.GLOBE({
      el: "#vanta-bg",
      mouseControls: true,
      touchControls: true,
      gyroControls: false,
      minHeight: 200,
      minWidth: 200,
      scale: 1,
      scaleMobile: 1,
      color: "#3b82f6",
      backgroundColor: "#111827",
      size: 0.8
    });

    // Feather icons
    feather.replace();

    // Isotope database
    const isotopeDatabase = {
      "Uranium-238": { symbol: "U-238", halfLife: 4.468e9, decays: [{ type: "α", product: "Thorium-234", branchingRatio: 1.0 }] },
      "Thorium-234": { symbol: "Th-234", halfLife: 24.1 / 365, decays: [{ type: "β⁻", product: "Protactinium-234", branchingRatio: 1.0 }] },
      "Protactinium-234": { symbol: "Pa-234", halfLife: 6.69 / (365*24), decays: [{ type: "β⁻", product: "Uranium-234", branchingRatio: 1.0 }] },
      "Uranium-234": { symbol: "U-234", halfLife: 2.455e5, decays: [{ type: "α", product: "Thorium-230", branchingRatio: 1.0 }] },
      "Thorium-230": { symbol: "Th-230", halfLife: 7.538e4, decays: [{ type: "α", product: "Radium-226", branchingRatio: 1.0 }] },
      "Radium-226": { symbol: "Ra-226", halfLife: 1600, decays: [{ type: "α", product: "Radon-222", branchingRatio: 1.0 }] },
      "Radon-222": { symbol: "Rn-222", halfLife: 3.8235 / 365, decays: [{ type: "α", product: "Polonium-218", branchingRatio: 1.0 }] },
      "Polonium-218": { symbol: "Po-218", halfLife: 3.10 / (365*24*60), decays: [{ type: "α", product: "Lead-214", branchingRatio: 0.9998 }, { type: "β⁻", product: "Astatine-218", branchingRatio: 0.0002 }] },
      "Lead-214": { symbol: "Pb-214", halfLife: 26.8 / (365*24*60), decays: [{ type: "β⁻", product: "Bismuth-214", branchingRatio: 1.0 }] },
      "Bismuth-214": { symbol: "Bi-214", halfLife: 19.9 / (365*24*60), decays: [{ type: "β⁻", product: "Polonium-214", branchingRatio: 0.9998 }, { type: "α", product: "Thallium-210", branchingRatio: 0.0002 }] },
      "Polonium-214": { symbol: "Po-214", halfLife: 0.0001643 / (365*24*60*60), decays: [{ type: "α", product: "Lead-210", branchingRatio: 1.0 }] },
      "Lead-210": { symbol: "Pb-210", halfLife: 22.3, decays: [{ type: "β⁻", product: "Bismuth-210", branchingRatio: 1.0 }] },
      "Bismuth-210": { symbol: "Bi-210", halfLife: 5.012 / 365, decays: [{ type: "β⁻", product: "Polonium-210", branchingRatio: 1.0 }] },
      "Polonium-210": { symbol: "Po-210", halfLife: 138.376 / 365, decays: [{ type: "α", product: "Lead-206", branchingRatio: 1.0 }] },
      "Lead-206": { symbol: "Pb-206", halfLife: Infinity, decays: [] }
    };

    const isotopeSearch = document.getElementById('isotope-search');
    const suggestions = document.getElementById('suggestions');
    const timeValue = document.getElementById('time-value');
    const timeUnit = document.getElementById('time-unit');
    const initialNuclei = document.getElementById('initial-nuclei');
    const calculateBtn = document.getElementById('calculate-btn');
    const resultsSection = document.getElementById('results-section');
    const decayProbability = document.getElementById('decay-probability');
    const remainingNuclei = document.getElementById('remaining-nuclei');
    const decayChain = document.getElementById('decay-chain');
    const interpretation = document.getElementById('interpretation');

    isotopeSearch.addEventListener('input', showSuggestions);
    isotopeSearch.addEventListener('focus', showSuggestions);
    document.addEventListener('click', (e) => { if (e.target !== isotopeSearch && e.target !== suggestions) suggestions.classList.add('hidden'); });
    calculateBtn.addEventListener('click', calculateDecay);

    function showSuggestions() {
      const searchTerm = isotopeSearch.value.toLowerCase();
      if (searchTerm.length < 1) { suggestions.classList.add('hidden'); return; }
      suggestions.innerHTML = '';
      const matches = Object.keys(isotopeDatabase).filter(iso => iso.toLowerCase().includes(searchTerm) || isotopeDatabase[iso].symbol.toLowerCase().includes(searchTerm));
      if (matches.length === 0) { suggestions.classList.add('hidden'); return; }
      matches.slice(0, 10).forEach(iso => {
        const div = document.createElement('div');
        div.className = 'p-3 hover:bg-blue-50 cursor-pointer flex justify-between items-center';
        div.innerHTML = `<span class="font-medium">${iso} (${isotopeDatabase[iso].symbol})</span>`;
        div.addEventListener('click', () => { isotopeSearch.value = iso; suggestions.classList.add('hidden'); });
        suggestions.appendChild(div);
      });
      suggestions.classList.remove('hidden');
    }

    function convertToSeconds(value, unit) {
      switch(unit) {
        case 'seconds': return value;
        case 'minutes': return value*60;
        case 'hours': return value*3600;
        case 'days': return value*86400;
        case 'years': return value*31557600;
        default: return value;
      }
    }

    function convertFromSeconds(seconds, unit) {
      switch(unit) {
        case 'seconds': return seconds;
        case 'minutes': return seconds/60;
        case 'hours': return seconds/3600;
        case 'days': return seconds/86400;
        case 'years': return seconds/31557600;
        default: return seconds;
      }
    }

    function formatHalfLife(halfLife) {
      if (halfLife === Infinity) return "Stable";
      if (halfLife >= 1e9) return (halfLife/1e9).toFixed(3)+" billion years";
      if (halfLife >= 1e6) return (halfLife/1e6).toFixed(3)+" million years";
      if (halfLife >= 1000) return (halfLife/1000).toFixed(3)+" thousand years";
      if (halfLife >= 1) return halfLife.toFixed(3)+" years";
      if (halfLife >= 1/365.25) return (halfLife*365.25).toFixed(3)+" days";
      if (halfLife >= 1/(365.25*24)) return (halfLife*365.25*24).toFixed(3)+" hours";
      if (halfLife >= 1/(365.25*24*60)) return (halfLife*365.25*24*60).toFixed(3)+" minutes";
      return (halfLife*365.25*24*60*60).toFixed(3)+" seconds";
    }

    function calculateDecay() {
      const isotopeName = isotopeSearch.value;
      if (!isotopeDatabase[isotopeName]) { alert("Please select a valid isotope from the suggestions"); return; }

      const time = parseFloat(timeValue.value);
      if (isNaN(time) || time<0) { alert("Please enter a valid time value"); return; }

      const nuclei = initialNuclei.value ? parseInt(initialNuclei.value) : 1;
      if (isNaN(nuclei) || nuclei<1) { alert("Please enter a valid number of initial nuclei"); return; }

      const timeInSeconds = convertToSeconds(time,timeUnit.value);
      const isotope = isotopeDatabase[isotopeName];
      const halfLifeInSeconds = convertToSeconds(isotope.halfLife,'years');
      const decayConst = Math.log(2)/halfLifeInSeconds;

      const prob = 1 - Math.exp(-decayConst*timeInSeconds);
      const remaining = nuclei * Math.exp(-decayConst*timeInSeconds);

      decayProbability.textContent = (prob*100).toFixed(6)+'%';
      remainingNuclei.textContent = remaining.toFixed(6);

      displayDecayChain(isotopeName,1.0);
      addInterpretation(isotopeName,prob,remaining,nuclei,time,timeUnit.value);
      resultsSection.classList.remove('hidden');

      document.querySelectorAll('.fade-in').forEach((card,index)=>{ card.style.animationDelay = `${index*0.1}s`; });
    }

    function displayDecayChain(isotopeName, cumulativeProbability, depth=0, parentContainer=null) {
      const isotope = isotopeDatabase[isotopeName];
      if (!isotope) return;
      if(depth===0){ decayChain.innerHTML=''; parentContainer=decayChain; }

      const element = document.createElement('div');
      element.className='decay-chain-item p-3 pl-'+(depth*4)+' border-l border-gray-600 text-gray-200';
      element.textContent=`${isotopeName} (${(cumulativeProbability*100).toFixed(3)}%)`;
      parentContainer.appendChild(element);

      isotope.decays.forEach(decay=>{
        displayDecayChain(decay.product,cumulativeProbability*decay.branchingRatio,depth+1,parentContainer);
      });
    }

    function addInterpretation(isotopeName,prob,remaining,nuclei,time,valueUnit){
      interpretation.innerHTML = `Starting with ${nuclei} nuclei of ${isotopeName}, after ${time} ${valueUnit}:
      <br>• Expected decay probability: ${(prob*100).toFixed(6)}%
      <br>• Expected remaining nuclei: ${remaining.toFixed(6)}
      <br>• Half-life of ${isotopeName}: ${formatHalfLife(isotopeDatabase[isotopeName].halfLife)}`;
    }
  </script>
</body>
</html>
